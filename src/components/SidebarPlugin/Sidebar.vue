<template>
  <div class="sidebar"
       :data-background-color="backgroundColor"
       :data-active-color="activeColor">
    <!--
            Tip 1: you can change the color of the sidebar's background using: data-background-color="white | black | darkblue"
            Tip 2: you can change the color of the active button using the data-active-color="primary | info | success | warning | danger"
        -->
    <!-- -->
    <div class="sidebar-wrapper" id="style-3">
      <div class="logo">
        <a href="#" class="simple-text">
            <div class="logo-img">
                <svg viewBox="0 0 150 77">
                  <title>EVRY Logo</title>
                  <desc>The EVRY logo.</desc>
                  <g id="nav-logo" stroke="none" stroke-width="1" fill-rule="evenodd">
                      <g id="Artboard-1" sketch:type="MSArtboardGroup">
                          <g id="evry-logo" sketch:type="MSLayerGroup">
                              <path d="M42.2769084,16.5424125 C44.0225492,16.2501203 46.3614352,15.8214593 47.0029372,20.2058428 C47.1964893,21.5278476 47.2012101,36.8309926 47.2012101,36.8309926 C47.2012101,36.8309926 48.881809,35.2578635 54.0395273,27.2985608 C57.948336,21.2659167 62.268902,13.4831215 63.8912779,10.754203 C64.8433026,9.15328553 66.5952378,7.49370376 69.6286034,9.72346122 C73.0081599,12.2084598 73.0847415,14.0054395 71.5992683,16.5537337 C70.0723571,19.1689258 65.9778642,25.8396726 60.1823157,33.8741068 C54.9202157,41.170606 52.4050871,44.0641961 50.1889415,46.4740632 C47.9733205,48.8839303 45.0254534,51.6617357 41.9464535,51.2335893 C37.8608777,50.6659867 38.175072,43.7472031 38.0129918,41.7675408 C37.8509116,39.7873638 37.0489029,24.0704813 37.5991365,20.4013904 C37.8131453,18.9769804 37.7549223,17.2993877 42.2769084,16.5424125"></path>
                              <path d="M97.5504643,16.9504895 C99.4345814,17.9549868 97.2714135,22.2956293 93.6395574,24.9298616 C91.3006714,26.6264945 87.3037414,29.1747887 83.1893163,29.1747887 C85.1977474,25.6873513 87.7154986,22.8570568 89.54454,21.0631647 C92.4803428,18.1829541 95.9076316,16.0736128 97.5504643,16.9504895 L97.5504643,16.9504895 Z M148.59787,15.99385 C150.416421,13.6637457 150.779396,12.2681533 147.765963,9.36530031 C145.063052,6.75988559 143.248698,8.2949344 141.926878,9.64627137 C141.707624,9.90768766 135.577424,15.9012222 129.125162,23.2049258 C124.102773,28.8907301 119.756505,34.1782348 119.756505,34.1782348 C119.756505,34.1782348 119.601769,30.6146367 120.142561,26.1417422 C120.45046,23.5949918 121.301775,18.6342575 121.55355,17.0652451 C122.828686,9.10542782 117.846686,8.78740564 115.990894,8.67470846 C114.038587,8.55532149 113.111216,9.5788589 112.532133,12.0046786 C112.000258,14.2287754 109.093304,26.4458702 110.253044,39.0293595 C110.462332,41.2997703 110.909233,43.6324476 110.95172,43.7852835 L109.779392,45.3903177 C98.852876,42.358815 91.3693851,34.9918158 91.3693851,34.9918158 C91.3693851,34.9918158 94.9535088,33.9631324 98.894314,31.6000938 C102.023669,29.7238659 108.050536,25.0816683 107.41323,16.8943982 C106.871389,9.94319499 99.4733967,6.77429436 96.7500292,7.34292625 C94.2705688,7.86009825 89.9305952,10.8298491 85.8350532,14.468064 C85.5591496,12.5671353 85.5108927,10.4742612 83.5370807,10.242177 C82.0883247,10.0718447 80.4077258,10.754203 79.1908127,11.3794408 C78.1092287,11.9346931 76.9306065,12.7441573 76.0614578,14.335812 L71.4634146,24.736887 C71.3144477,25.1079128 71.0159893,25.1840735 70.7757538,25.238621 C68.314652,25.7985047 67.5226095,27.5553457 67.3468914,28.0447293 C67.3468914,28.0447293 66.3182851,30.2147933 68.1347377,32.1764447 C67.2236265,34.579622 64.8050118,40.1877219 64.8050118,40.1877219 C61.8052161,47.0648229 61.9982437,49.4525622 63.0714352,50.9155672 C63.6164234,51.6591627 65.5251935,52.7331308 67.8320831,53.1098173 C69.570905,53.3943905 70.9000678,52.3687947 72.3524955,50.0963256 C74.4967803,46.7421693 78.8037084,37.8920957 78.8037084,37.8920957 C78.8037084,37.8920957 87.3672097,47.101874 104.554009,53.160248 C104.554009,53.160248 95.464927,65.4879816 94.1530737,72.3028161 C94.1530737,72.3028161 93.4769526,76.77005 99.6013824,76.7587288 C101.138784,76.7561558 103.458787,76.3933635 105.135714,75.3806327 C105.868485,74.9385922 106.341088,74.3251902 106.526772,73.6217333 C106.61227,73.300109 106.541459,72.9193057 106.398262,72.666123 C106.231985,72.3738308 105.964474,72.2112175 105.766726,72.0182429 C105.452007,71.7089689 105.498166,71.3106692 105.669163,70.8511323 C109.039278,61.2024011 122.739516,44.8021311 125.648043,41.2467666 C133.355509,31.8275466 147.590245,17.1655919 148.59787,15.99385 L148.59787,15.99385 Z"></path>
                              <path d="M2.80014314,44.1866707 C3.44007157,45.7778108 3.50458894,46.8461183 3.24861757,48.5098169 C3.05296732,49.7741866 2.82269799,51.0328957 2.57197194,52.2874881 C2.3548159,53.373292 1.84025049,55.7270678 2.5929532,56.6214409 C3.32257651,57.4880256 4.78077408,57.4396533 6.48025614,57.2332991 C8.36437329,57.0043025 17.7923025,55.0935964 27.7069969,51.0025344 C29.0518957,50.4225813 30.4266927,49.7227267 31.5937753,48.84585 C34.28672,46.8193591 34.7205076,42.5677422 34.7205076,42.5677422 C34.7907948,41.755705 34.7792551,40.5921967 33.695573,39.9890867 C32.9072022,39.5501337 31.8161767,39.824415 30.1833101,40.2607949 C27.4803993,40.9827773 20.7952453,43.5017394 18.4768161,44.1835831 C17.5368556,44.4609519 15.6852594,44.8947589 14.9708475,44.0132508 C13.7827837,42.5481875 15.4833148,37.9574498 16.501955,35.3998928 C17.5211197,32.840792 19.1193672,30.787542 24.0331783,29.3996685 C25.8370421,28.8897009 28.7922526,27.9701125 29.9965769,27.5682107 C31.313151,27.1271993 33.0519729,26.2745088 33.7910378,23.3510719 C34.6329108,20.0149266 32.0532649,19.5034152 29.698643,18.863254 C26.3295772,17.945724 24.2141416,17.831483 25.6917469,14.6193561 C26.2960072,13.306614 26.8609276,12.7246026 28.174879,12.3834234 C29.5129588,12.0350399 40.8528053,10.2720237 45.3669234,9.46410332 C47.8956898,9.0128 48.7532988,7.67535721 49.8091807,5.5207312 C52.0924663,0.86155188 49.231147,0.556909273 46.9195367,0.766351065 C41.6967765,1.23978214 33.312665,2.73675063 29.7196243,3.24826203 C27.8056088,3.5209995 29.0812694,0.314533145 26.8441426,0.159638847 C22.4459459,-0.143459962 18.7070854,1.67616209 17.2137442,2.81342588 C15.8011809,3.88790858 15.1287315,7.20810132 15.1287315,7.20810132 L10.7709238,22.0069393 C10.3953593,23.715408 9.85928807,25.3991759 8.62716357,26.1232167 C5.63103965,27.889835 -0.478703268,28.0112804 0.0673340239,34.4983154 C0.0673340239,34.4983154 0.186927206,37.6852269 2.80014314,44.1866707"></path>
                          </g>
                      </g>
                  </g>
              </svg>
            </div>
          {{title}}
        </a>
      </div>
      <ul class="nav">
        <!--By default vue-router adds an active class to each route link. This way the links are colored when clicked-->
        <slot name="links">
        </slot>
      </ul>
      <moving-arrow :move-y="arrowMovePx">

      </moving-arrow>
    </div>
  </div>
</template>

<script>
import MovingArrow from "./MovingArrow.vue";
export default {
 props: {
    title: {
      type: String,
      default: "ControlRoom"
    },
    backgroundColor: {
      type: String,
      default: "black",
      validator: value => {
        let acceptedValues = ["white", "black", "darkblue"];
        return acceptedValues.indexOf(value) !== -1;
      }
    },
    activeColor: {
      type: String,
      default: "success",
      validator: value => {
        let acceptedValues = [
          "primary",
          "info",
          "success",
          "warning",
          "danger"
        ];
        return acceptedValues.indexOf(value) !== -1;
      }
    },
    sidebarLinks: {
      type: Array,
      default: () => []
    },
    autoClose: {
      type: Boolean,
      default: true
    }
  },
  provide() {
    return {
      autoClose: this.autoClose,
      addLink: this.addLink,
      removeLink: this.removeLink
    };
  },
  components: {
    MovingArrow
  },
  computed: {
    /**
     * Styles to animate the arrow near the current active sidebar link
     * @returns {{transform: string}}
     */
    arrowMovePx() {
      return this.linkHeight * this.activeLinkIndex;
    }
  },
  data() {
    return {
      linkHeight: 65,
      activeLinkIndex: 0,
      links: []
    };
  },
  methods: {
    findActiveLink() {
      this.links.forEach((link, index) => {
        if (link.isActive()) {
          this.activeLinkIndex = index;
        }
      });
    },
    addLink(link) {
      const index = this.$slots.links.indexOf(link.$vnode);
      this.links.splice(index, 0, link);
    },
    removeLink(link) {
      const index = this.links.indexOf(link);
      if (index > -1) {
        this.links.splice(index, 1);
      }
    }
  },
  mounted() {
    this.$watch("$route", this.findActiveLink, {
      immediate: true
    });
  }
};
</script>